{
  "inode": {
    "org": "",
    "id": "cmdb_workflow-141gcq4h5h7i9",
    "schema_id": "cmdb_schema_workflow-0",
    "name": "[AutoGen] 运维工单（测试）Launcher 工作流",
    "namespace": "",
    "descr": "",
    "ctime": 0,
    "mtime": 0,
    "creator": "",
    "last_editor": "",
    "archived": false,
    "lock": ""
  },
  "data": {
    "persist_level": "job_unit",
    "persist_retention": 3600,
    "nodes": [
      {
        "component": "cmdb_component-vars",
        "descr": "起始节点",
        "config": {
          "schema": {
            "type": "object",
            "properties": {
              "ticket_name": {
                "type": "string"
              },
              "ticket_descr": {
                "type": "string"
              },
              "ticket_input": {
                "type": "object",
                "properties": {
                  "[auto]4d5d0_input": {
                    "type": "object",
                    "properties": {},
                    "required": [],
                    "title": "输入"
                  }
                },
                "title": "工单发起参数"
              }
            }
          }
        },
        "inputs": {
          "*": {}
        },
        "auto_run": true,
        "name": "__START__"
      },
      {
        "name": "Prepare",
        "auto_run": true,
        "component": "cmdb_component-interpreter_ecmascript",
        "inputs": {
          "__START__": "{var:__START__.output}"
        },
        "config": {
          "script": "resources/scripts/cmdb_workflow-141gcq4h5h7i9.data.nodes.1.config.script.js",
          "timeout_s": -1,
          "input_schema": "{\"type\":\"object\",\"properties\":{\"ticket_name\":{\"type\":\"string\"},\"ticket_descr\":{\"type\":\"string\"},\"ticket_input\":{\"type\":\"object\",\"properties\":{\"[auto]4d5d0_input\":{\"type\":\"object\",\"properties\":{},\"required\":[],\"title\":\"输入\"}},\"title\":\"工单发起参数\"}}}",
          "output_schema": "{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"string\"},\"result_name\":{\"type\":\"string\"},\"message\":{\"type\":\"string\"},\"ticket_info\":{\"type\":\"object\",\"properties\":{\"ticket_template\":{\"type\":\"object\",\"properties\":{\"ticket_name\":{\"type\":\"string\"},\"ticket_descr\":{\"type\":\"string\"},\"ticket_type\":{\"type\":\"string\"},\"steps\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"name\":{\"type\":\"string\"},\"component_id\":{\"type\":\"string\"},\"config\":{\"type\":\"object\"},\"input\":{\"type\":\"object\"},\"fail_policy\":{\"type\":\"string\"},\"set_vars\":{\"type\":\"array\",\"items\":{\"type\":\"object\"}},\"premise\":{\"type\":\"array\",\"items\":{\"type\":\"object\"}}}}},\"input_schema\":{\"type\":\"string\"},\"vars_schema\":{\"type\":\"string\"}}},\"ticket_instance\":{\"type\":\"object\",\"properties\":{\"ticket_instance_id\":{\"type\":\"string\"},\"step_instances\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"ticket_input\":{\"type\":\"object\"}}}}}}}"
        },
        "descr": "准备「工单实例」"
      },
      {
        "component": "cmdb_component-vars",
        "config": {
          "schema": {
            "title": "工单实例返回信息",
            "type": "object",
            "properties": {
              "result": {
                "type": "string"
              },
              "result_name": {
                "type": "string"
              },
              "message": {
                "type": "string"
              },
              "ticket_info": {
                "type": "object",
                "properties": {
                  "ticket_instance_id": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "inputs": {
          "Prepare": {
            "result": "{var:Prepare.output.result}",
            "result_name": "{var:Prepare.output.result_name}",
            "message": "{var:Prepare.output.message}",
            "ticket_info": {
              "ticket_instance_id": "{var:Prepare.output.ticket_info.ticket_instance.ticket_instance_id}"
            }
          }
        },
        "name": "__END__",
        "auto_run": true,
        "descr": "返回节点"
      },
      {
        "name": "PrepareOK",
        "auto_run": true,
        "component": "cmdb_component-condition",
        "inputs": {
          "Prepare": {
            "target": "SUCCEEDED",
            "value": "{var:Prepare.output.result}"
          }
        },
        "config": {
          "op": "字符串-相等"
        },
        "descr": "工单实例准备完成"
      },
      {
        "name": "ExecuteAndWait",
        "auto_run": true,
        "component": "cmdb_component-interpreter_ecmascript",
        "inputs": {
          "PrepareOK": {
            "ticket_instance": "{var:Prepare.output.ticket_info.ticket_instance}",
            "ticket_template": "{var:Prepare.output.ticket_info.ticket_template}"
          }
        },
        "config": {
          "script": "resources/scripts/cmdb_workflow-141gcq4h5h7i9.data.nodes.4.config.script.js",
          "timeout_s": -1,
          "input_schema": "{\"type\":\"object\",\"properties\":{\"ticket_template\":{\"type\":\"object\"},\"ticket_instance\":{\"type\":\"object\"}}}",
          "output_schema": "{}"
        }
      }
    ],
    "edges": [
      {
        "from": "__START__",
        "to": "Prepare"
      },
      {
        "from": "Prepare",
        "to": "PrepareOK"
      },
      {
        "from": "Prepare",
        "to": "__END__"
      },
      {
        "from": "PrepareOK",
        "to": "ExecuteAndWait"
      }
    ]
  },
  "indexes": {}
}